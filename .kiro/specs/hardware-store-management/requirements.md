# 需求文档 - 五金店管理系统

## 简介

五金店管理系统旨在解决传统五金零售店在库存管理、进货管理、销售开单和记录方面的效率问题。系统将帮助店主实现库存盘点自动化、进货流程规范化、快速开单以及销售数据统计分析。

## 术语表

- **系统 (System)**: 五金店管理系统
- **库存管理模块 (Inventory_Module)**: 负责商品库存信息管理的子系统
- **进货管理模块 (Procurement_Module)**: 负责进货流程管理的子系统
- **销售管理模块 (Sales_Module)**: 负责销售开单和记录的子系统
- **商品 (Product)**: 五金店销售的物品，包含名称、规格、单价等信息
- **库存记录 (Inventory_Record)**: 商品的当前库存数量和位置信息
- **存放位置 (Storage_Location)**: 商品在店内的物理存放位置，如货架号、抽屉号、区域等
- **基本单位 (Base_Unit)**: 商品的最小计量单位，用于库存统一管理
- **包装单位 (Package_Unit)**: 商品的包装或批量单位，与基本单位存在换算关系
- **单位换算 (Unit_Conversion)**: 包装单位与基本单位之间的数量换算比例
- **进货单 (Purchase_Order)**: 记录一次进货的详细信息
- **销售单 (Sales_Order)**: 记录一次销售交易的详细信息
- **退货单 (Return_Order)**: 记录客户退货或向供应商退货的详细信息
- **盘点 (Stock_Taking)**: 对实际库存进行清点并与系统记录对比的过程
- **抹零 (Rounding_Discount)**: 对销售单总金额进行小额减免的操作
- **改价 (Price_Adjustment)**: 对销售单中商品单价进行临时调整的操作

## 需求

### 需求 1: 商品信息管理

**用户故事**: 作为店主，我希望能够管理商品的基本信息，以便系统能够准确记录和识别每一种商品。

#### 验收标准

1. THE 系统 SHALL 允许添加新商品，包含商品名称、规格型号、基本单位、进货价、零售价、供应商信息
2. WHEN 添加商品时，THE 系统 SHALL 验证必填字段（商品名称、基本单位、零售价）不为空
3. THE 系统 SHALL 允许修改已存在商品的信息
4. THE 系统 SHALL 允许查询商品信息，支持按名称、规格模糊搜索
5. THE 系统 SHALL 为每个商品生成唯一的商品编码
6. THE 系统 SHALL 允许为商品配置多个包装单位及其与基本单位的换算比例
7. WHEN 配置包装单位时，THE 系统 SHALL 验证换算比例为大于零的数值
8. THE 系统 SHALL 允许为商品设置存放位置信息（如货架号、抽屉号、区域）
9. WHEN 查询商品时，THE 系统 SHALL 显示商品的存放位置
10. THE 系统 SHALL 支持按存放位置搜索商品

### 需求 1.1: 多单位换算管理

**用户故事**: 作为店主，我希望系统支持商品的多单位管理，以便进货时按箱/包计量，销售时按个/件计量，系统自动进行单位换算。

#### 验收标准

1. THE 系统 SHALL 使用基本单位统一管理商品库存数量
2. WHEN 添加包装单位时，THE 系统 SHALL 记录包装单位名称和换算比例（1个包装单位等于多少个基本单位）
3. THE 系统 SHALL 允许为同一商品配置多个包装单位（例如：箱、盒、包）
4. WHEN 进货或销售时选择包装单位，THE 系统 SHALL 自动将数量换算为基本单位进行库存计算
5. THE 系统 SHALL 在显示库存时支持按不同单位显示（例如：1000个 = 10箱）
6. WHEN 删除包装单位时，IF 该单位已被历史订单使用，THEN THE 系统 SHALL 阻止删除并提示用户
7. THE 系统 SHALL 支持小数数量输入，精度至少保留到小数点后两位
8. WHEN 商品单位为长度、重量等连续计量单位时，THE 系统 SHALL 允许输入非整数数量（如 3.5 米、1.2 公斤）

### 需求 2: 库存管理

**用户故事**: 作为店主，我希望能够实时查看库存情况并进行盘点，以便及时了解商品库存状态和补货需求。

#### 验收标准

1. THE 系统 SHALL 实时显示每个商品的当前库存数量
2. THE 系统 SHALL 允许为每个商品单独设置最低库存阈值
3. WHEN 库存数量低于该商品设定的最低库存阈值时，THE 系统 SHALL 发出库存预警提示
4. THE 系统 SHALL 在商品列表中突出显示库存预警的商品
5. THE 系统 SHALL 支持库存盘点功能，允许录入实际盘点数量
6. WHEN 完成盘点时，THE 系统 SHALL 计算盘点差异（实际数量与系统数量的差值）
7. WHEN 确认盘点结果时，THE 系统 SHALL 更新库存数量并记录盘点历史
8. THE 系统 SHALL 显示库存变动历史记录，包含时间、类型（进货/销售/盘点调整/退货）、数量变化

### 需求 3: 进货管理

**用户故事**: 作为店主，我希望能够记录和管理进货信息，以便追踪进货历史和成本。

#### 验收标准

1. THE 系统 SHALL 允许创建进货单，包含供应商、进货日期、商品清单（商品、数量、单位、进货价）
2. WHEN 创建进货单时，THE 系统 SHALL 验证商品清单不为空且数量大于零
3. WHEN 添加商品到进货单时，THE 系统 SHALL 允许选择该商品配置的任意单位（基本单位或包装单位）
4. WHEN 确认进货单时，THE 系统 SHALL 将所有商品数量换算为基本单位后增加库存
5. THE 系统 SHALL 计算进货单的总金额
6. THE 系统 SHALL 允许查询历史进货记录，支持按日期范围、供应商筛选
7. THE 系统 SHALL 显示每次进货的详细信息和状态（待确认/已入库）

### 需求 3.1: 进货退货管理

**用户故事**: 作为店主，我希望能够向供应商退货，以便处理次品或多余库存。

#### 验收标准

1. THE 系统 SHALL 允许基于原进货单创建退货单
2. WHEN 创建退货单时，THE 系统 SHALL 显示原进货单的商品清单
3. THE 系统 SHALL 允许选择部分或全部商品进行退货
4. WHEN 选择退货商品时，THE 系统 SHALL 验证退货数量不超过原进货数量
5. WHEN 确认退货单时，THE 系统 SHALL 将退货商品数量从库存中减少
6. THE 系统 SHALL 计算退货金额并记录退款信息
7. THE 系统 SHALL 在原进货单上标记已退货状态和退货数量

### 需求 4: 销售开单

**用户故事**: 作为店主，我希望能够快速为客户开具销售单，以便提高收银效率和减少手工记账错误。

#### 验收标准

1. THE 系统 SHALL 允许创建销售单，包含客户信息（可选）、销售日期、商品清单（商品、数量、单位、单价）
2. WHEN 添加商品到销售单时，THE 系统 SHALL 允许选择该商品配置的任意单位（基本单位或包装单位）
3. WHEN 添加商品到销售单时，THE 系统 SHALL 自动填充商品的零售价
4. WHEN 添加商品到销售单时，THE 系统 SHALL 将数量换算为基本单位后验证库存是否充足
5. IF 库存不足，THEN THE 系统 SHALL 显示警告信息并阻止添加
6. THE 系统 SHALL 自动计算销售单的总金额和应收金额
7. THE 系统 SHALL 支持折扣功能，允许按百分比或固定金额折扣
8. THE 系统 SHALL 支持抹零功能，允许对总金额进行小额减免（如 102 元抹零为 100 元）
9. THE 系统 SHALL 支持改价功能，允许临时修改商品单价
10. WHEN 确认销售单时，THE 系统 SHALL 将所有商品数量换算为基本单位后减少库存
11. THE 系统 SHALL 支持打印销售单据

### 需求 4.1: 销售退货管理

**用户故事**: 作为店主，我希望能够处理客户退货，以便准确调整库存和账目。

#### 验收标准

1. THE 系统 SHALL 允许基于原销售单创建退货单
2. WHEN 创建退货单时，THE 系统 SHALL 显示原销售单的商品清单
3. THE 系统 SHALL 允许选择部分或全部商品进行退货
4. WHEN 选择退货商品时，THE 系统 SHALL 验证退货数量不超过原销售数量
5. WHEN 确认退货单时，THE 系统 SHALL 将退货商品数量增加回库存
6. THE 系统 SHALL 计算退货金额并记录退款信息
7. THE 系统 SHALL 在原销售单上标记已退货状态和退货数量

### 需求 5: 销售记录与统计

**用户故事**: 作为店主，我希望能够查看销售记录和统计数据，以便分析经营状况和做出决策。

#### 验收标准

1. THE 系统 SHALL 记录所有已确认的销售单信息
2. THE 系统 SHALL 允许查询历史销售记录，支持按日期范围、商品筛选
3. THE 系统 SHALL 提供销售统计报表，显示指定时间段内的总销售额、总销售数量
4. THE 系统 SHALL 提供商品销售排行，显示销售数量最多的商品
5. THE 系统 SHALL 提供日销售汇总，显示每日的销售额和订单数量
6. THE 系统 SHALL 计算并显示毛利润（销售额减去进货成本）

### 需求 6: 数据持久化

**用户故事**: 作为店主，我希望系统能够可靠地保存所有数据，以便数据不会因为程序关闭而丢失。

#### 验收标准

1. WHEN 添加或修改数据时，THE 系统 SHALL 立即将数据持久化到存储介质
2. WHEN 系统启动时，THE 系统 SHALL 加载所有已保存的数据
3. THE 系统 SHALL 使用结构化格式（如 JSON 或数据库）存储数据
4. THE 系统 SHALL 确保数据完整性，防止数据损坏

### 需求 7: 用户界面

**用户故事**: 作为店主，我希望系统界面简洁易用，以便快速上手和日常操作。

#### 验收标准

1. THE 系统 SHALL 提供清晰的导航菜单，包含商品管理、库存管理、进货管理、销售管理等主要功能模块
2. THE 系统 SHALL 在执行操作后提供明确的成功或失败反馈
3. WHEN 用户输入无效数据时，THE 系统 SHALL 显示清晰的错误提示信息
4. THE 系统 SHALL 支持键盘快捷操作，提高录入效率
5. THE 系统 SHALL 在需要确认的操作（如删除、确认订单）前显示确认对话框
